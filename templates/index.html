{% extends "layout.html" %}
{% block head_content %}
{% endblock head_content %}
{% block body_content %}

    {% if current_path != "/"  %}
            <a href="{{ back_button_path }}"><div class="back-button"><div class="arrow"></div></div></a>
    {% else %}
        <div class="back-button"><div class="home"></div></div>
    {% endif %}
    {% if usermode == "admin" %}
        <div class="controls_menu_button" onclick="options_menu()"><p style="font-size: 6vh;font-weight: bold;position: relative;top: 3vh;left: 0.9vh;">...</p></div>
        <div class="controls_menu" id="controls_menu" style="display:none">

            <div class="upload-button" onclick="upload_form()">
                <div class="title">Upload</div>
            </div>

            <div class="aaa">
                    <form action="/" method="POST" enctype= "multipart/form-data">
                        <input type="text" placeholder="URL" name="url_text">
                        <input type="submit" value="open">
                        <input type="hidden" value="openurl_request" name="request">
                    </form>
            </div>
            <div class="aaa">
                    <form action="/" method="POST" enctype= "multipart/form-data">
                        <input type="text" placeholder="command" name="shell_command">
                        <input type="submit" value="run">
                        <input type="hidden" value="shell_request" name="request">
                    </form>
            </div>
            <div class="aaa">
                    <form action="/" method="POST" enctype= "multipart/form-data">
                        <input type="text" placeholder="folder name" name="dirname">
                        <input type="submit">
                        <input type="hidden" value="create_folder_request" name="request">
                        <input type="hidden" value="{{ current_path }}" name="path">
                    </form>
            </div>
        </div>
        <div class="upload-form" id="upload_form_container" style="display:none;">
                <center>
                <form method="POST" action="/" enctype= "multipart/form-data">

                    <input type="file" name="file">
                    <input type="hidden" value="upload_request" name="request">
                    <input type="hidden" value="{{ current_path }}" name="path">
                    <input type="submit" value="submit">

                </form>
                </center>
        </div>
    {% endif %}
        <p style="background:black;color:green;width:fit-content;padding: 1vh;font-size: 3vh;border-radius: 3vh;">files:{{ files_num['files']  }} -  folders:{{ files_num['folders']  }}</p>
        <form action="/" method="POST" encrypt="multipart/form-data">
            <input type="text" style="" value="{{ current_path }}" name="url" class="url-mon">
            <input type="hidden" value="redierct_request" name="request">

        </form>
    <div class="files_m">
    {% for i in files_data %}
            {% if i['type'] == "img" %}
                <a onclick="media_view(`{{ i['path'] }}` , `img`)" target="_blank" style="display:inline-block;width:100%;">
            {% elif i["type"] == "video" %}  
                <a onclick="media_view(`{{ i['path'] }}` , `video`)" target="_blank" style="display:inline-block;width:100%;">
            {% else %}
                <a href="{{ i['path'] }}" style="display:inline-block;width:100%;">
            {% endif %}
                <div class="folder">
                    <div class="file_name">{{ i['name'] }}</div>
            </div>
            <center>
                {% if i['type'] == "img" %}
                    <img src="{{ i['path'] }}" class="media"></img>
                {% elif i['type'] == "video" %}
                    <video src="{{ i['path'] }}" muted autoplay loop class="media"></video>
                {% endif %}
                </center>
            </a>
             {% if usermode == "admin" %} 
                <button onclick="delete_file(name=`{{ i['name'] }}` , file_path=`{{ i['path']  }}` , current_path=`{{ current_path }}`)" class="delete_button" style="display: inline-block;position: absolute;right: 4vh;">
                      <p sytle="font-size: 2vh;">Delete</p>
                </button>
             {% endif %}
    {% endfor %}
    </div>

    <div class="media_monitor" id="media_monitor" style="display:none;"></div>
    <div class="delete_submit" id="delete_submit" style="display:none;"></div>
    <script src="{{ url_for('static' , filename='js/main.js') }}"></script>
{% endblock body_content %}
